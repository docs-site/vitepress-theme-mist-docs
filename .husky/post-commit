#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Checking if sdoc directory files were modified in this commit..."

# æ£€æŸ¥æœ¬æ¬¡æäº¤ä¸­æ˜¯å¦ä¿®æ”¹äº† src/sdoc ç›®å½•ä¸‹çš„æ–‡ä»¶
# ä½¿ç”¨æ›´å¥å£®çš„æ–¹æ³•ï¼Œå¤„ç†ç¬¬ä¸€æ¬¡æäº¤ç­‰ç‰¹æ®Šæƒ…å†µ
if git rev-parse --verify HEAD^ >/dev/null 2>&1; then
    # æ­£å¸¸æƒ…å†µï¼šæœ‰ä¸Šä¸€ä¸ªæäº¤
    if git diff --name-only HEAD^ HEAD | grep -q "^src/sdoc/"; then
        echo "âœ… sdoc directory files were modified. Running copy script..."
        npm run copy:sdoc
    else
        echo "â­ï¸  No sdoc directory files modified in this commit. Skipping copy."
    fi
else
    # ç¬¬ä¸€æ¬¡æäº¤æˆ–å…¶ä»–ç‰¹æ®Šæƒ…å†µï¼šæ£€æŸ¥å½“å‰å·¥ä½œæ ‘ä¸­æ‰€æœ‰ sdoc æ–‡ä»¶
    if git ls-files --modified --others --exclude-standard | grep -q "^src/sdoc/"; then
        echo "âœ… sdoc directory files detected. Running copy script..."
        npm run copy:sdoc
    else
        echo "â­ï¸  No sdoc directory files detected. Skipping copy."
    fi
fi
