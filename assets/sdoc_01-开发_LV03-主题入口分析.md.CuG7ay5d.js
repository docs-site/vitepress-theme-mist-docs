import{_ as a,c as i,o as e,b0 as n}from"./chunks/framework.ih_0trda.js";const c=JSON.parse('{"title":"LV03-主题入口分析","description":null,"frontmatter":{"title":"LV03-主题入口分析","date":"2025-09-03T19:30:53.000Z","icon":"famicons:logo-markdown","permalink":"/sdoc/develop/126b07e425dd17023e4d75e5","index":true,"tags":null,"categories":null,"copyright":false,"keywords":null,"cover":null,"comments":null,"mathjax":null,"top":null,"description":null,"tdoc":{"detailDate":"2025-09-03T19:30:53.368Z","fulluuid":"23e4d75e56e041f692beffd2f289b351","useduuid":"23e4d75e5"}},"headers":[],"relativePath":"sdoc/01-开发/LV03-主题入口分析.md","filePath":"sdoc/01-开发/LV03-主题入口分析.md","lastUpdated":1755354469000}'),t={name:"sdoc/01-开发/LV03-主题入口分析.md"};function l(p,s,o,d,h,r){return e(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="lv03-主题入口分析" tabindex="-1">LV03-主题入口分析 <a class="header-anchor" href="#lv03-主题入口分析" aria-label="Permalink to &quot;LV03-主题入口分析&quot;">​</a></h1><h2 id="一、开发指南" tabindex="-1">一、开发指南 <a class="header-anchor" href="#一、开发指南" aria-label="Permalink to &quot;一、开发指南&quot;">​</a></h2><p>主题的主入口文件为<code>packages/mist/index.ts</code>，这里的index.ts将会在vitepress站点的<code>.vitepress/theme/index.ts</code>中导入和调用。</p><h2 id="二、workspace-机制详解" tabindex="-1">二、Workspace 机制详解 <a class="header-anchor" href="#二、workspace-机制详解" aria-label="Permalink to &quot;二、Workspace 机制详解&quot;">​</a></h2><h3 id="_1-项目配置分析" tabindex="-1">1. 项目配置分析 <a class="header-anchor" href="#_1-项目配置分析" aria-label="Permalink to &quot;1. 项目配置分析&quot;">​</a></h3><h4 id="_1-1-pnpm-workspace-yaml" tabindex="-1">1.1 pnpm-workspace.yaml <a class="header-anchor" href="#_1-1-pnpm-workspace-yaml" aria-label="Permalink to &quot;1.1 pnpm-workspace.yaml&quot;">​</a></h4><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># pnpm-workspace.yaml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">packages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">docs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">packages/*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这个配置定义了 Workspace 的范围，包含了 <code>packages</code> 目录下的所有子目录。</p><h4 id="_1-2-packages-mist-package-json" tabindex="-1">1.2 packages/mist/package.json <a class="header-anchor" href="#_1-2-packages-mist-package-json" aria-label="Permalink to &quot;1.2 packages/mist/package.json&quot;">​</a></h4><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;private&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@docs-site/vitepress-theme-mist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;description&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;main&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./index.ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./index.ts&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>关键点：</p><ul><li><code>&quot;name&quot;: &quot;@docs-site/vitepress-theme-mist&quot;</code> 定义了这个包的唯一标识符</li><li><code>&quot;module&quot;: &quot;./index.ts&quot;</code> 指定了 ES 模块的入口文件</li><li><code>&quot;private&quot;: true</code> 表示这个包不会被发布到 npm</li></ul><h4 id="_1-3-docs-package-json" tabindex="-1">1.3 docs/package.json <a class="header-anchor" href="#_1-3-docs-package-json" aria-label="Permalink to &quot;1.3 docs/package.json&quot;">​</a></h4><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;devDependencies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;@docs-site/vitepress-theme-mist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;workspace:*&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>&quot;@docs-site/vitepress-theme-mist&quot;: &quot;workspace:*&quot;</code> 声明了一个 Workspace 依赖</li><li><code>workspace:*</code> 告诉 pnpm 这个依赖应该从 Workspace 中查找，而不是从 npm 下载</li></ul><p>添加对 <code>@docs-site/vitepress-theme-mist</code> 的依赖，可以使用以下命令：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @docs-site/vitepress-theme-mist@workspace:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @docs-site/vitepress-theme-mist-docs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>或者也可以手动添加，然后执行<code>pnpm install</code>。</p><h3 id="_2-导入解析过程" tabindex="-1">2. 导入解析过程 <a class="header-anchor" href="#_2-导入解析过程" aria-label="Permalink to &quot;2. 导入解析过程&quot;">​</a></h3><p>当我们执行 <code>import Mist from &quot;@docs-site/vitepress-theme-mist&quot;</code> 时，完整的解析过程如下：</p><p>（1）模块解析（Node.js）</p><ul><li>Node.js 模块解析器在当前目录及父目录中查找 <code>node_modules</code></li><li>在 <code>docs/node_modules/</code> 中找到 <code>@docs-site/vitepress-theme-mist</code></li><li>发现符号链接：<code>docs/node_modules/@docs-site/vitepress-theme-mist -&gt; ../../packages/mist</code></li></ul><p>（2）包解析（package.json）</p><ul><li>读取 <code>packages/mist/package.json</code> 文件</li><li>根据 <code>module</code> 字段知道应该加载 <code>./index.ts</code> 文件</li></ul><p>（3）文件加载</p><ul><li>加载 <code>packages/mist/index.ts</code> 文件</li></ul>`,26)])])}const u=a(t,[["render",l]]);export{c as __pageData,u as default};
