import{_ as a,c as i,o as n,b0 as e}from"./chunks/framework.ih_0trda.js";const l="/vitepress-theme-mist-docs/assets/image-20250826202835500.P6jBRT8Z.png",p="/vitepress-theme-mist-docs/assets/image-20250826203438915.lddhSanU.png",t="/vitepress-theme-mist-docs/assets/image-20250826203628570.DBofsHVq.png",h="data:image/png;base64,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",r="/vitepress-theme-mist-docs/assets/image-20250826204717160.CVhgVsHa.png",d="/vitepress-theme-mist-docs/assets/image-20250826205103654.B85iPa7C.png",o="/vitepress-theme-mist-docs/assets/image-20250826205644056.fGyOxBW0.png",y=JSON.parse('{"title":"LV10-changesets","description":null,"frontmatter":{"title":"LV10-changesets","date":"2025-09-03T19:30:53.000Z","icon":"famicons:logo-markdown","permalink":"/sdoc/develop/126b07e425dd18a17fa41782","index":true,"tags":null,"categories":null,"copyright":false,"keywords":null,"cover":null,"comments":null,"mathjax":null,"top":null,"description":null,"tdoc":{"detailDate":"2025-09-03T19:30:53.394Z","fulluuid":"17fa41782581414ea91dda82301287f3","useduuid":"17fa41782"}},"headers":[],"relativePath":"sdoc/01-开发/LV10-changesets.md","filePath":"sdoc/01-开发/LV10-changesets.md","lastUpdated":1757686915000}'),k={name:"sdoc/01-开发/LV10-changesets.md"};function c(g,s,b,u,E,m){return n(),i("div",null,[...s[0]||(s[0]=[e(`<h1 id="lv10-changesets" tabindex="-1">LV10-changesets <a class="header-anchor" href="#lv10-changesets" aria-label="Permalink to &quot;LV10-changesets&quot;">​</a></h1><h2 id="一、changesets是什么" tabindex="-1">一、Changesets是什么 <a class="header-anchor" href="#一、changesets是什么" aria-label="Permalink to &quot;一、Changesets是什么&quot;">​</a></h2><h3 id="_1-简介" tabindex="-1">1. 简介 <a class="header-anchor" href="#_1-简介" aria-label="Permalink to &quot;1. 简介&quot;">​</a></h3><p>Changesets 是一个专为 monorepo 项目设计的版本管理和变更日志生成工具。与 Standard-Version 不同，Changesets 采用手动创建变更集（changeset）的方式，让开发者能够精确控制每个版本包含的变更内容。它特别适合多包管理的复杂项目，提供更灵活的版本控制策略。</p><p>Changesets 的核心思想是&quot;变更集驱动&quot;——开发者需要手动创建变更集文件来描述所做的更改，然后工具会根据这些变更集自动更新版本号、生成变更日志，并处理包之间的依赖关系。</p><p><strong>核心特点</strong>：</p><ul><li>在开发时，需要开发者提供本次变更涉及的包名称、升级版本类型（<code>patch</code>、<code>minor</code>、<code>major</code>）及变更信息</li><li>在发布版本时，会根据变更集自动升级对应包的版本号，并在对应的包中生成 <code>Changelog</code> 信息</li><li>在 <code>Monorepo</code> 场景中，会自动生成仓库依赖图，升级时只会升级变更包及相关依赖包的版本号</li></ul><h3 id="_2-会做那些事" tabindex="-1">2. 会做那些事？ <a class="header-anchor" href="#_2-会做那些事" aria-label="Permalink to &quot;2. 会做那些事？&quot;">​</a></h3><p>在版本发布过程中，Changesets 会自动完成以下工作：</p><p>（1）<strong>管理变更集</strong>：创建和管理 <code>.changeset</code> 目录下的变更集文件</p><p>（2）<strong>版本更新</strong>：根据变更集内容自动更新各个包的版本号</p><p>（3）<strong>生成变更日志</strong>：自动生成和更新 CHANGELOG.md 文件</p><p>（4）<strong>依赖管理</strong>：处理 monorepo 中包之间的依赖关系更新</p><p>（5）<strong>发布管理</strong>：支持预发布模式和正式发布流程</p><h3 id="_3-相关依赖" tabindex="-1">3. 相关依赖 <a class="header-anchor" href="#_3-相关依赖" aria-label="Permalink to &quot;3. 相关依赖&quot;">​</a></h3><p>在使用之前需要先安装：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @changesets/cli</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者使用 pnpm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @changesets/cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p><a href="https://github.com/changesets/changesets" target="_blank" rel="noreferrer">GitHub - changesets/changesets: 🦋 A way to manage your versioning and changelogs with a focus on monorepos</a></p></blockquote><p>初始化 Changesets：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+l+`" alt="image-20250826202835500"></p><p>初始化完会自动生成两个文件：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .changeset</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> README.md</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="二、基本用法与配置" tabindex="-1">二、基本用法与配置 <a class="header-anchor" href="#二、基本用法与配置" aria-label="Permalink to &quot;二、基本用法与配置&quot;">​</a></h2><h3 id="_1-基本用法" tabindex="-1">1. 基本用法 <a class="header-anchor" href="#_1-基本用法" aria-label="Permalink to &quot;1. 基本用法&quot;">​</a></h3><p>在 package.json 中添加以下命令：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;changeset&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cs:version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;changeset version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cs:release&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;changeset publish&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cs:pre&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;changeset pre enter&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cs:pre:exit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;changeset pre exit&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>脚本命令详细说明：</strong></p><h4 id="_1-1-cs-changeset-交互式创建变更集文件" tabindex="-1">1.1 <code>cs</code> (<code>changeset</code>): 交互式创建变更集文件 <a class="header-anchor" href="#_1-1-cs-changeset-交互式创建变更集文件" aria-label="Permalink to &quot;1.1 \`cs\` (\`changeset\`): 交互式创建变更集文件&quot;">​</a></h4><h5 id="_1-1-1-功能描述" tabindex="-1">1.1.1 功能描述 <a class="header-anchor" href="#_1-1-1-功能描述" aria-label="Permalink to &quot;1.1.1 功能描述&quot;">​</a></h5><p>启动交互式命令行界面，引导开发者创建变更集文件。该命令会逐步询问以下信息：</p><ul><li>选择受影响的包（在 monorepo 中会列出所有可用包）</li><li>选择变更类型（major/minor/patch）</li><li>填写变更描述信息</li></ul><h5 id="_1-1-2-工作流程" tabindex="-1">1.1.2 工作流程 <a class="header-anchor" href="#_1-1-2-工作流程" aria-label="Permalink to &quot;1.1.2 工作流程&quot;">​</a></h5><p>（1）运行命令后，会显示当前工作区中的所有包列表</p><blockquote><p><strong>包列表来源</strong>：Changesets 会自动扫描工作区中的 <code>package.json</code> 文件，根据以下规则确定要显示的包：</p><ul><li>在 monorepo 中，会读取 <code>pnpm-workspace.yaml</code> 或 <code>lerna.json</code> 配置的工作区范围</li><li>识别所有包含有效 <code>name</code> 和 <code>version</code> 字段的 <code>package.json</code> 文件</li><li>排除标记为 <code>private: true</code> 的私有包</li><li>默认情况下会显示所有可发布的公共包</li></ul></blockquote><p>（2）使用空格键选择受影响的包（可多选）</p><p>（3）为每个选中的包选择版本变更类型</p><p>（4）输入详细的变更描述（支持多行 Markdown 格式）</p><p>（5）确认后会在 <code>.changeset</code> 目录下生成新的变更集文件</p><h5 id="_1-1-3-生成文件" tabindex="-1">1.1.3 生成文件 <a class="header-anchor" href="#_1-1-3-生成文件" aria-label="Permalink to &quot;1.1.3 生成文件&quot;">​</a></h5><p>在 <code>.changeset</code> 目录下创建随机命名的 Markdown 文件，格式为：</p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;package-name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch/minor/major</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">变更描述内容...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="_1-1-4-注意事项" tabindex="-1">1.1.4 注意事项 <a class="header-anchor" href="#_1-1-4-注意事项" aria-label="Permalink to &quot;1.1.4 注意事项&quot;">​</a></h5><ul><li>变更集文件需要提交到版本控制中</li><li>描述信息应该清晰详细，便于后续生成变更日志</li><li>可以多次运行此命令为不同的变更创建多个变更集</li></ul><h4 id="_1-2-cs-version-changeset-version-根据变更集更新版本号" tabindex="-1">1.2 <code>cs:version</code> (<code>changeset version</code>): 根据变更集更新版本号 <a class="header-anchor" href="#_1-2-cs-version-changeset-version-根据变更集更新版本号" aria-label="Permalink to &quot;1.2 \`cs:version\` (\`changeset version\`): 根据变更集更新版本号&quot;">​</a></h4><h5 id="_1-2-1-功能描述" tabindex="-1">1.2.1 功能描述 <a class="header-anchor" href="#_1-2-1-功能描述" aria-label="Permalink to &quot;1.2.1 功能描述&quot;">​</a></h5><p>读取所有未处理的变更集文件，自动执行以下操作：</p><ul><li>更新相关包的版本号（根据变更集中指定的类型）</li><li>生成或更新 CHANGELOG.md 文件</li><li>删除已处理的变更集文件</li></ul><h5 id="_1-2-2-工作流程" tabindex="-1">1.2.2 工作流程 <a class="header-anchor" href="#_1-2-2-工作流程" aria-label="Permalink to &quot;1.2.2 工作流程&quot;">​</a></h5><p>（1）扫描 <code>.changeset</code> 目录下的所有变更集文件</p><p>（2）解析每个文件中的包名和版本变更类型</p><p>（3）按照 semver 规范更新 package.json 中的版本号</p><p>（4）在对应包的目录中生成/更新 CHANGELOG.md 文件</p><p>（5）删除已处理的变更集文件</p><h5 id="_1-2-3-影响范围" tabindex="-1">1.2.3 影响范围 <a class="header-anchor" href="#_1-2-3-影响范围" aria-label="Permalink to &quot;1.2.3 影响范围&quot;">​</a></h5><ul><li>修改 package.json 文件中的版本号</li><li>创建或更新 CHANGELOG.md 文件</li><li>更新包之间的依赖关系版本号</li></ul><h5 id="_1-2-4-注意事项" tabindex="-1">1.2.4 注意事项 <a class="header-anchor" href="#_1-2-4-注意事项" aria-label="Permalink to &quot;1.2.4 注意事项&quot;">​</a></h5><ul><li>此命令会修改文件，建议先提交当前更改</li><li>变更日志的格式可以通过配置文件自定义</li><li>对于 monorepo，会自动处理包间的依赖版本更新</li></ul><h4 id="_1-3-cs-release-changeset-publish-发布包到-npm-注册表" tabindex="-1">1.3 <code>cs:release</code> (<code>changeset publish</code>): 发布包到 npm 注册表 <a class="header-anchor" href="#_1-3-cs-release-changeset-publish-发布包到-npm-注册表" aria-label="Permalink to &quot;1.3 \`cs:release\` (\`changeset publish\`): 发布包到 npm 注册表&quot;">​</a></h4><h5 id="_1-3-1-功能描述" tabindex="-1">1.3.1 功能描述 <a class="header-anchor" href="#_1-3-1-功能描述" aria-label="Permalink to &quot;1.3.1 功能描述&quot;">​</a></h5><p>发布所有版本号已更新但尚未发布的包到 npm 注册表。</p><h5 id="_1-3-2-发布机制" tabindex="-1">1.3.2 发布机制 <a class="header-anchor" href="#_1-3-2-发布机制" aria-label="Permalink to &quot;1.3.2 发布机制&quot;">​</a></h5><p>（1）<strong>版本检查</strong>：对比本地包版本和 npm 上的已发布版本</p><p>（2）<strong>发布条件</strong>：只发布满足以下条件的包：</p><ul><li>版本号比 npm 上更新的包（本地版本 &gt; 远程版本）</li><li>新包（从未发布过的包）</li><li>非私有包（<code>private</code> 不为 <code>true</code>）</li></ul><p>（3）<strong>依赖处理</strong>：确保依赖关系正确发布</p><blockquote><p><strong>前置要求：</strong></p><ul><li>需要先登录 npm：<code>npm login</code></li><li>具有对应包的发布权限</li><li>网络连接正常</li></ul></blockquote><h5 id="_1-3-3-发布流程" tabindex="-1">1.3.3 发布流程 <a class="header-anchor" href="#_1-3-3-发布流程" aria-label="Permalink to &quot;1.3.3 发布流程&quot;">​</a></h5><p>（1）检查每个包的发布状态</p><p>（2）构建包（如果配置了构建脚本）</p><p>（3）发布到 npm 注册表</p><p>（4）更新发布状态信息</p><h5 id="_1-3-4-注意事项" tabindex="-1">1.3.4 注意事项 <a class="header-anchor" href="#_1-3-4-注意事项" aria-label="Permalink to &quot;1.3.4 注意事项&quot;">​</a></h5><ul><li>对于 <code>@scope/package</code> 形式的包，默认需要组织权限</li><li>可以通过 <code>publishConfig.access</code> 配置发布权限</li><li>发布前建议先进行本地测试</li></ul><h4 id="_1-4-cs-pre-changeset-pre-enter-进入预发布模式" tabindex="-1">1.4 <code>cs:pre</code> (<code>changeset pre enter</code>): 进入预发布模式 <a class="header-anchor" href="#_1-4-cs-pre-changeset-pre-enter-进入预发布模式" aria-label="Permalink to &quot;1.4 \`cs:pre\` (\`changeset pre enter\`): 进入预发布模式&quot;">​</a></h4><h5 id="_1-4-1-功能描述" tabindex="-1">1.4.1 功能描述 <a class="header-anchor" href="#_1-4-1-功能描述" aria-label="Permalink to &quot;1.4.1 功能描述&quot;">​</a></h5><p>切换到预发布状态，后续的版本号会添加预发布标识（如 alpha、beta、rc）。</p><p>适用场景如下：</p><ul><li>功能开发完成，需要进行内部测试</li><li>重大变更需要收集用户反馈</li><li>发布候选版本进行最终验证</li></ul><h5 id="_1-4-2-使用方法" tabindex="-1">1.4.2 使用方法 <a class="header-anchor" href="#_1-4-2-使用方法" aria-label="Permalink to &quot;1.4.2 使用方法&quot;">​</a></h5><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入 alpha 预发布模式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alpha</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入 beta 预发布模式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> beta</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入 rc 预发布模式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="_1-4-3-执行效果" tabindex="-1">1.4.3 执行效果 <a class="header-anchor" href="#_1-4-3-执行效果" aria-label="Permalink to &quot;1.4.3 执行效果&quot;">​</a></h5><ul><li>设置预发布状态标识</li><li>后续执行 <code>cs:version</code> 时，版本号会附加预发布标识</li><li>例如：<code>1.0.0</code> → <code>1.0.0-alpha.0</code> → <code>1.0.0-alpha.1</code></li></ul><h5 id="_1-4-3-注意事项" tabindex="-1">1.4.3 注意事项 <a class="header-anchor" href="#_1-4-3-注意事项" aria-label="Permalink to &quot;1.4.3 注意事项&quot;">​</a></h5><ul><li>预发布版本通常不建议用于生产环境</li><li>预发布模式可以随时退出并恢复正常发布流程</li></ul><h4 id="_1-5-cs-pre-exit-changeset-pre-exit-退出预发布模式" tabindex="-1">1.5 <code>cs:pre:exit</code> (<code>changeset pre exit</code>): 退出预发布模式 <a class="header-anchor" href="#_1-5-cs-pre-exit-changeset-pre-exit-退出预发布模式" aria-label="Permalink to &quot;1.5 \`cs:pre:exit\` (\`changeset pre exit\`): 退出预发布模式&quot;">​</a></h4><h5 id="_1-5-1-功能描述" tabindex="-1">1.5.1 功能描述 <a class="header-anchor" href="#_1-5-1-功能描述" aria-label="Permalink to &quot;1.5.1 功能描述&quot;">​</a></h5><p>结束预发布状态，恢复正常版本发布流程。</p><h5 id="_1-5-2-执行效果" tabindex="-1">1.5.2 执行效果 <a class="header-anchor" href="#_1-5-2-执行效果" aria-label="Permalink to &quot;1.5.2 执行效果&quot;">​</a></h5><ul><li>清除预发布状态标识</li><li>后续版本号恢复正常的 semver 格式</li><li>需要重新运行 <code>cs:version</code> 来生成正式版本</li></ul><h5 id="_1-5-3-退出流程" tabindex="-1">1.5.3 退出流程 <a class="header-anchor" href="#_1-5-3-退出流程" aria-label="Permalink to &quot;1.5.3 退出流程&quot;">​</a></h5><p>（1）运行 <code>cs:pre:exit</code> 退出预发布模式</p><p>（2）运行 <code>cs:version</code> 生成正式版本号</p><p>（3）运行 <code>cs:release</code> 发布正式版本</p><h5 id="_1-5-4-注意事项" tabindex="-1">1.5.4 注意事项 <a class="header-anchor" href="#_1-5-4-注意事项" aria-label="Permalink to &quot;1.5.4 注意事项&quot;">​</a></h5><ul><li>退出预发布模式后，预发布版本的变更集仍然有效</li><li>建议在退出前确保所有预发布版本的问题都已修复</li><li>退出后无法再发布相同版本的预发布包</li></ul><h3 id="_2-配置文件详解" tabindex="-1">2. 配置文件详解 <a class="header-anchor" href="#_2-配置文件详解" aria-label="Permalink to &quot;2. 配置文件详解&quot;">​</a></h3><p>配置文件位于 <code>.changeset/config.json</code>：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;$schema&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://unpkg.com/@changesets/config@3.1.1/schema.json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;changelog&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@changesets/cli/changelog&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;commit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;fixed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;linked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;access&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;public&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;baseBranch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;updateInternalDependencies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;patch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;ignore&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_2-1-changelog" tabindex="-1">2.1 <code>changelog</code> <a class="header-anchor" href="#_2-1-changelog" aria-label="Permalink to &quot;2.1 \`changelog\`&quot;">​</a></h4><p>变更日志生成器配置</p><ul><li>设置为 <code>false</code> 时，执行 <code>version</code> 命令时，在 <code>CHANGELOG.md</code> 文件中只声明版本号，不声明其他 <code>Changelog</code> 信息</li><li>可以使用内置的 <code>@changesets/cli/changelog</code> 或自定义生成器</li></ul><h4 id="_2-2-commit" tabindex="-1">2.2 <code>commit</code> <a class="header-anchor" href="#_2-2-commit" aria-label="Permalink to &quot;2.2 \`commit\`&quot;">​</a></h4><p>是否自动创建 Git 提交和打 tag</p><ul><li>为 <code>true</code> 时，在执行 <code>change</code> 和 <code>version</code> 命令时，将自动执行以下操作： <ul><li>创建 Git 提交，提交消息格式为：<code>chore: update versions</code></li><li>为每个更新的包创建 Git tag，tag 格式为：<code>包名@版本号</code>（例如：<code>@mist/components@1.2.0</code>）</li><li>自动推送提交和 tags 到远程仓库（如果配置了自动推送）</li></ul></li><li>默认：<code>false</code></li><li><strong>注意</strong>：自动提交功能需要配置 Git 用户信息，且在 CI/CD 环境中可能需要额外的权限配置</li></ul><h4 id="_2-3-fixed" tabindex="-1">2.3 <code>fixed</code> <a class="header-anchor" href="#_2-3-fixed" aria-label="Permalink to &quot;2.3 \`fixed\`&quot;">​</a></h4><p>用于 <code>monorepo</code> 中对包进行分组</p><ul><li>相同分组中的包版本号将进行绑定，每次执行 <code>version</code> 命令时，同一分组中的包只要有一个升级版本号，其他会一起升级</li><li>支持使用正则匹配包名称</li></ul><h4 id="_2-4-linked" tabindex="-1">2.4 <code>linked</code> <a class="header-anchor" href="#_2-4-linked" aria-label="Permalink to &quot;2.4 \`linked\`&quot;">​</a></h4><p>和 <code>fixed</code> 类似，也是对 <code>monorepo</code> 中对包进行分组</p><ul><li>每次执行 <code>version</code> 命令时，只有和 <code>changeset</code> 声明的变更相关的包才会升级版本号</li><li>同一分组的变更包的版本号将保持一致</li><li>支持使用正则匹配包名称</li></ul><h4 id="_2-5-access" tabindex="-1">2.5 <code>access</code> <a class="header-anchor" href="#_2-5-access" aria-label="Permalink to &quot;2.5 \`access\`&quot;">​</a></h4><p>发布权限配置</p><ul><li>如果配置为 <code>restricted</code>，将作为私有包发布</li><li>如果为 <code>public</code>，则发布公共范围包</li></ul><blockquote><p>对于仓库中存在部分包需要特殊配置 access，可以在 <code>package.json</code> 中配置 <code>publishConfig</code>：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;publishConfig&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;registry&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://registry.npmjs.org/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;access&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;public&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></blockquote><h4 id="_2-6-basebranch" tabindex="-1">2.6 <code>baseBranch</code> <a class="header-anchor" href="#_2-6-basebranch" aria-label="Permalink to &quot;2.6 \`baseBranch\`&quot;">​</a></h4><p>仓库主分支名称</p><ul><li>该配置用于计算当前分支的变更包并进行分类</li><li>默认：<code>&quot;main&quot;</code></li></ul><p>这里要改成自己的仓库使用的分支，不然在使用的时候可能会有警告：</p><p><img src="`+p+`" alt="image-20250826203438915"></p><p>上图这里就是用分支是master，但是配置的main。</p><h4 id="_2-7-updateinternaldependencies" tabindex="-1">2.7 <code>updateInternalDependencies</code> <a class="header-anchor" href="#_2-7-updateinternaldependencies" aria-label="Permalink to &quot;2.7 \`updateInternalDependencies\`&quot;">​</a></h4><p>用于声明更新内部依赖的版本号规则</p><ul><li>当执行 <code>version</code> 命令升级版本号时，默认会自动更新仓库中使用该包的依赖声明</li><li>配置该字段为 <code>minor</code> 后，如果升级版本号为 <code>patch</code> 类型，将不会自动更新引用依赖声明</li></ul><blockquote><p>例如：当配置 <code>updateInternalDependencies</code> 为 <code>minor</code> 时，升级 <code>pkg-a</code> 至 <code>1.0.1</code> 时，<code>pkg-b</code> 中的 <code>pkg-a</code> 的依赖版本将不会更新，只有 <code>pkg-a</code> 升级版本号为 <code>1.1.0</code> 或者 <code>2.0.0</code> 时，才会更新 <code>pkg-b</code> 中的 <code>pkg-a</code> 的依赖。</p></blockquote><h4 id="_2-8-ignore" tabindex="-1">2.8 <code>ignore</code> <a class="header-anchor" href="#_2-8-ignore" aria-label="Permalink to &quot;2.8 \`ignore\`&quot;">​</a></h4><p>用于声明执行 version 命令时忽略的包</p><ul><li>和 <code>version</code> 命令的 <code>--ignore</code> 参数用法一致，注意两者不能同时使用</li></ul><h3 id="_3-变更集文件格式" tabindex="-1">3. 变更集文件格式 <a class="header-anchor" href="#_3-变更集文件格式" aria-label="Permalink to &quot;3. 变更集文件格式&quot;">​</a></h3><p>每个变更集是一个 Markdown 文件，位于 <code>.changeset</code> 目录下，格式如下：</p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;package-name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">描述此次变更的内容，支持 Markdown 格式。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">可以包含多行描述，详细说明变更的影响和原因。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>一个变更集文件包含了在某个分支或者 <code>commit</code> 上改动信息，包括：</p><ul><li>本次变更涉及哪些包的变更</li><li>本次变更需要升级的版本号类型，类型符合 <a href="https://peiyanlu.github.io/vite-press/npm/SemVer" target="_blank" rel="noreferrer">semver</a> 规范</li><li>本次变更的 <code>Changelog</code> 信息</li></ul><p>这个文件的本质是对包的版本和 <code>Changelog</code> 做一个预存储，我们也可以在这些文件中修改信息。</p><p><strong>版本类型说明：</strong></p><ul><li><code>major</code>: 重大变更，不向后兼容</li><li><code>minor</code>: 新增功能，向后兼容</li><li><code>patch</code>: Bug 修复，向后兼容</li></ul><h2 id="三、工作流程详解" tabindex="-1">三、工作流程详解 <a class="header-anchor" href="#三、工作流程详解" aria-label="Permalink to &quot;三、工作流程详解&quot;">​</a></h2><p>Changesets 的工作流程是一个精确控制的发布过程，具体步骤如下：</p><h3 id="_1-第一次发布" tabindex="-1">1. 第一次发布 <a class="header-anchor" href="#_1-第一次发布" aria-label="Permalink to &quot;1. 第一次发布&quot;">​</a></h3><p>对于新项目的第一次发布，需要先构建并直接发布：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建项目</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 直接发布</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>@xxx/xx</code> 形式的包会被当作私有包，默认需要以组织的方式登录，可以通过参数发布为公共包：</li></ul><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --access</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li><code>changeset publish</code> 时指定参数不生效，此时可以在 <code>package.json</code> 中指定配置：</li></ul><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;publishConfig&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;access&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;public&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>不需要发布的包可以在 <code>package.json</code> 中设置：</li></ul><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;private&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-开发阶段" tabindex="-1">2. 开发阶段 <a class="header-anchor" href="#_2-开发阶段" aria-label="Permalink to &quot;2. 开发阶段&quot;">​</a></h3><p>（1）<strong>开发功能</strong>：进行代码开发和修改</p><p>（2）<strong>创建变更集</strong>：运行 <code>pnpm cs</code> 命令创建变更集</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>具体变更集创建过程可以看下一节。</p><h3 id="_3-变更集创建过程" tabindex="-1">3. 变更集创建过程 <a class="header-anchor" href="#_3-变更集创建过程" aria-label="Permalink to &quot;3. 变更集创建过程&quot;">​</a></h3><h4 id="_3-1-模块工程方案" tabindex="-1">3.1 模块工程方案 <a class="header-anchor" href="#_3-1-模块工程方案" aria-label="Permalink to &quot;3.1 模块工程方案&quot;">​</a></h4><p>在根目录执行 <code>pnpm changeset</code>，选择本次变更需要升级的版本号类型，填入 <code>Changelog</code> 信息，并点击两次回车，执行完成后，将在项目的 <code>.changeset</code> 目录创建对应的变更集文件</p><h4 id="_3-2-monorepo-工程方案" tabindex="-1">3.2 Monorepo 工程方案 <a class="header-anchor" href="#_3-2-monorepo-工程方案" aria-label="Permalink to &quot;3.2 Monorepo 工程方案&quot;">​</a></h4><p>在根目录执行 <code>pnpm changeset</code>，选择本次需要升级的包列表，分别选择不同版本类型对应的包，<code>changeset</code> 会询问版本号类型，如果存在包未选择这两种类型，将会默认使用 <code>patch</code> 类型，填入 <code>Changelog</code> 信息，并点击两次回车，执行完成后，将在项目的 <code>.changeset</code> 目录创建对应的变更集文件</p><ul><li>假设现在要进行迭代，我们从主分支上切一个分支出来，完成代码修改，如果需要变更记录，执行 <code>pnpm changeset</code> 命令生成变更集文件，最后提交代码</li><li>变更集文件需要一并提交到远程仓库中。在后续的新版本发布后，这些变更集文件是会被自动消耗掉的</li></ul><p>（3）<strong>选择包</strong>：交互式选择受影响的包</p><p>（4）<strong>选择变更类型</strong>：选择 major/minor/patch</p><p>（5）<strong>填写描述</strong>：详细描述变更内容</p><h4 id="_3-3-使用实例" tabindex="-1">3.3 使用实例 <a class="header-anchor" href="#_3-3-使用实例" aria-label="Permalink to &quot;3.3 使用实例&quot;">​</a></h4><h5 id="_3-3-1-选择要变更的包" tabindex="-1">3.3.1 选择要变更的包 <a class="header-anchor" href="#_3-3-1-选择要变更的包" aria-label="Permalink to &quot;3.3.1 选择要变更的包&quot;">​</a></h5><p>我们按前面的初始化好Changesets，然后执行 pnpm cs命令，会有以下提示信息出现：</p><p><img src="`+t+'" alt="image-20250826203628570"></p><p>这里就会列出工作区所有的包，我们选择下面的<code>vitepress-plugin-doc-analysis</code>这个包，用方向键移动到这个包的位置，然后按下空格：</p><p><img src="'+h+'" alt="image-20250826203750320"></p><h5 id="_3-3-2-选择变更类型" tabindex="-1">3.3.2 选择变更类型 <a class="header-anchor" href="#_3-3-2-选择变更类型" aria-label="Permalink to &quot;3.3.2 选择变更类型&quot;">​</a></h5><p>选择完包之后，Changesets会询问版本变更类型：</p><p><img src="'+r+`" alt="image-20250826204717160"></p><p>这里是从<code>major/minor/patch/</code>中让我们确认的，若是major需要更新patch编号，那么前两个就不要选择对应的包</p><blockquote><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">patch (1.0.0 -&gt; 1.0.1) Bug修复，向后兼容的小改动</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minor (1.0.0 -&gt; 1.1.0) 新增功能，向后兼容的功能添加</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">major (1.0.0 -&gt; 2.0.0) 重大变更，不向后兼容的破坏性改动</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></blockquote><p>我这里选择的就是更新patch，然后在下面填上描述信息：</p><p><img src="`+d+`" alt="image-20250826205103654"></p><p>这个信息最终将会在对应的CHANGELOG文件。然后最后选择true即可。</p><h5 id="_3-3-3-生成变更集文件" tabindex="-1">3.3.3 生成变更集文件 <a class="header-anchor" href="#_3-3-3-生成变更集文件" aria-label="Permalink to &quot;3.3.3 生成变更集文件&quot;">​</a></h5><p>就会在<code>.changeset</code>目录生成一个随机命名的变更集文档：</p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@docs-site/vitepress-plugin-doc-analysis&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">更新@docs-site/vitepress-plugin-doc-analysis 版本</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>每次变更都会生成单独的变更集文档，同一个包的多个变更集文档最终会被合并起来。</p><h3 id="_4-版本发布阶段" tabindex="-1">4. 版本发布阶段 <a class="header-anchor" href="#_4-版本发布阶段" aria-label="Permalink to &quot;4. 版本发布阶段&quot;">​</a></h3><p>（6）<strong>更新版本</strong>：运行 <code>pnpm cs:version</code> 根据变更集更新版本</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+o+`" alt="image-20250826205644056"></p><p>运行完毕后就会在对应的包的目录生成一个CHANGELOG.md文档，同时<code>.changeset</code>目录的变更集文件会消失，然后就会发现package.json中版本号发生了变化。</p><p>（7）<strong>检查变更</strong>：查看生成的变更日志和版本更新</p><p>（8）<strong>发布版本</strong>：运行 <code>pnpm cs:release</code> 发布新版本</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:release</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>changeset</code> 会检查当前工作区中所有包的版本是否已经被发布过，如果没有则自动发布。</p><h3 id="_5-预发布流程" tabindex="-1">5. 预发布流程 <a class="header-anchor" href="#_5-预发布流程" aria-label="Permalink to &quot;5. 预发布流程&quot;">​</a></h3><h4 id="_5-1-进入预发布模式" tabindex="-1">5.1 进入预发布模式 <a class="header-anchor" href="#_5-1-进入预发布模式" aria-label="Permalink to &quot;5.1 进入预发布模式&quot;">​</a></h4><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发布 alpha 版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alpha</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发布 beta 版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> beta</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发布 rc 版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rc</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_5-2-修改包的版本" tabindex="-1">5.2 修改包的版本 <a class="header-anchor" href="#_5-2-修改包的版本" aria-label="Permalink to &quot;5.2 修改包的版本&quot;">​</a></h4><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>执行后包的版本发生变化，其他项目依赖此包的版本也相应发生变化</p><h4 id="_5-3-发布测试版本" tabindex="-1">5.3 发布测试版本 <a class="header-anchor" href="#_5-3-发布测试版本" aria-label="Permalink to &quot;5.3 发布测试版本&quot;">​</a></h4><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建项目</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发布测试版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_5-4-退出预发布模式" tabindex="-1">5.4 退出预发布模式 <a class="header-anchor" href="#_5-4-退出预发布模式" aria-label="Permalink to &quot;5.4 退出预发布模式&quot;">​</a></h4><p>发布前退出预发布模式：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pre</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_6-正式发布流程" tabindex="-1">6. 正式发布流程 <a class="header-anchor" href="#_6-正式发布流程" aria-label="Permalink to &quot;6. 正式发布流程&quot;">​</a></h3><p>（1）<strong>修改版本号</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>（2）<strong>发布正式版本</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changeset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_7-完整流程示例" tabindex="-1">7. 完整流程示例 <a class="header-anchor" href="#_7-完整流程示例" aria-label="Permalink to &quot;7. 完整流程示例&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 开发并提交代码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;feat: 添加新功能&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 创建变更集</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 选择包: @mist/components</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 选择变更类型: minor</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 描述: 添加新的按钮组件变体</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 更新版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 检查变更</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diff</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 提交版本更新</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;chore: update versions&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. 发布</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:release</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="四、变更集规范" tabindex="-1">四、变更集规范 <a class="header-anchor" href="#四、变更集规范" aria-label="Permalink to &quot;四、变更集规范&quot;">​</a></h2><h3 id="_1-变更集文件规范" tabindex="-1">1. 变更集文件规范 <a class="header-anchor" href="#_1-变更集文件规范" aria-label="Permalink to &quot;1. 变更集文件规范&quot;">​</a></h3><p>每个变更集文件必须包含：</p><ul><li><strong>Frontmatter</strong>: 使用 YAML 格式指定包和变更类型</li><li><strong>描述内容</strong>: 详细描述变更内容，使用 Markdown 格式</li></ul><h3 id="_2-变更集示例" tabindex="-1">2. 变更集示例 <a class="header-anchor" href="#_2-变更集示例" aria-label="Permalink to &quot;2. 变更集示例&quot;">​</a></h3><h4 id="_2-1-示例-1-功能新增" tabindex="-1">2.1 示例 1：功能新增 <a class="header-anchor" href="#_2-1-示例-1-功能新增" aria-label="Permalink to &quot;2.1 示例 1：功能新增&quot;">​</a></h4><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/components&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">添加新的 PrimaryButton 组件，支持多种尺寸和主题变体。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 支持 small/medium/large 三种尺寸</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 支持 primary/secondary 两种主题</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 添加完整的类型定义和文档</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_2-2-示例-2-bug-修复" tabindex="-1">2.2 示例 2：Bug 修复 <a class="header-anchor" href="#_2-2-示例-2-bug-修复" aria-label="Permalink to &quot;2.2 示例 2：Bug 修复&quot;">​</a></h4><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/utils&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">修复日期格式化函数在处理闰年时的错误。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">具体问题：2月29日格式化时会出现日期偏移，现已修复。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_2-3-示例-3-重大变更" tabindex="-1">2.3 示例 3：重大变更 <a class="header-anchor" href="#_2-3-示例-3-重大变更" aria-label="Permalink to &quot;2.3 示例 3：重大变更&quot;">​</a></h4><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/core&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">major</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">重构事件系统，不再支持旧的事件监听方式。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-light-font-weight:bold;--shiki-dark:#E1E4E8;--shiki-dark-font-weight:bold;">**破坏性变更：**</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 移除 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`on()\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 方法，改为使用 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\`addEventListener()\`</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 事件名称统一使用 camelCase 格式</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 需要更新所有使用事件监听的代码</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="五、生成格式示例" tabindex="-1">五、生成格式示例 <a class="header-anchor" href="#五、生成格式示例" aria-label="Permalink to &quot;五、生成格式示例&quot;">​</a></h2><h3 id="_1-一般格式示例" tabindex="-1">1. 一般格式示例 <a class="header-anchor" href="#_1-一般格式示例" aria-label="Permalink to &quot;1. 一般格式示例&quot;">​</a></h3><p><strong>变更集文件：</strong></p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/components&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minor</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/utils&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">添加新的模态框组件并修复工具函数中的日期处理问题。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>生成的 CHANGELOG.md：</strong></p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;"># @mist/components</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## 1.2.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Minor Changes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 添加新的模态框组件 ([</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">a1b2c3d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://github.com/owner/repo/commit/a1b2c3d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;"># @mist/utils</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## 1.1.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Patch Changes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 修复日期处理函数 ([</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">d4e5f6g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://github.com/owner/repo/commit/d4e5f6g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Updated dependencies [</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">a1b2c3d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @mist/components@1.2.0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_2-多包协同示例" tabindex="-1">2. 多包协同示例 <a class="header-anchor" href="#_2-多包协同示例" aria-label="Permalink to &quot;2. 多包协同示例&quot;">​</a></h3><p><strong>多个相关变更集：</strong></p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/core&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minor</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@mist/components&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minor</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">重构主题系统，所有组件支持新的主题配置。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>生成的变更日志会显示依赖关系：</strong></p><div class="language-markdown vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;"># @mist/components</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">## 2.1.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Minor Changes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 支持新的主题配置系统 ([</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">e7f8g9h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">](</span><span style="--shiki-light:#24292E;--shiki-light-text-decoration:underline;--shiki-dark:#E1E4E8;--shiki-dark-text-decoration:underline;">https://github.com/owner/repo/commit/e7f8g9h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;">### Patch Changes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Updated dependencies [</span><span style="--shiki-light:#032F62;--shiki-light-text-decoration:underline;--shiki-dark:#DBEDFF;--shiki-dark-text-decoration:underline;">e7f8g9h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]:</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @mist/core@2.1.0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_3-文件处理机制" tabindex="-1">3. 文件处理机制 <a class="header-anchor" href="#_3-文件处理机制" aria-label="Permalink to &quot;3. 文件处理机制&quot;">​</a></h3><ul><li><strong>变更集文件位置</strong>: 所有变更集文件存储在 <code>.changeset</code> 目录下</li><li><strong>文件命名</strong>: 使用随机生成的名称，如 <code>quick-lions-study.md</code></li><li><strong>文件清理</strong>: 在 <code>changeset version</code> 执行后，已处理的变更集文件会被自动删除</li><li><strong>版本追踪</strong>: 每个变更集都会生成对应的 Git 提交哈希链接</li></ul><h2 id="六、changesets-适用场景" tabindex="-1">六、Changesets 适用场景 <a class="header-anchor" href="#六、changesets-适用场景" aria-label="Permalink to &quot;六、Changesets 适用场景&quot;">​</a></h2><h3 id="_1-主要适用场景" tabindex="-1">1. 主要适用场景 <a class="header-anchor" href="#_1-主要适用场景" aria-label="Permalink to &quot;1. 主要适用场景&quot;">​</a></h3><p>（1）<strong>Monorepo 项目</strong>：多包管理的复杂项目结构</p><p>（2）<strong>精确版本控制</strong>：需要手动审核每个变更的场景</p><p>（3）<strong>团队协作</strong>：多个开发者同时修改不同包的项目</p><p>（4）<strong>复杂依赖关系</strong>：包之间存在复杂的依赖关系需要协调</p><p>（5）<strong>预发布管理</strong>：需要灵活的预发布和测试流程</p><h3 id="_2-与-standard-version-对比" tabindex="-1">2. 与 Standard-Version 对比 <a class="header-anchor" href="#_2-与-standard-version-对比" aria-label="Permalink to &quot;2. 与 Standard-Version 对比&quot;">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th>Changesets</th><th>Standard-Version</th></tr></thead><tbody><tr><td>适用项目</td><td>Monorepo</td><td>单包项目</td></tr><tr><td>变更控制</td><td>手动创建变更集</td><td>自动分析提交历史</td></tr><tr><td>版本策略</td><td>精确控制每个变更</td><td>基于提交类型自动决定</td></tr><tr><td>工作流程</td><td>变更集驱动</td><td>提交历史驱动</td></tr><tr><td>学习曲线</td><td>较高</td><td>较低</td></tr><tr><td>灵活性</td><td>高</td><td>中等</td></tr></tbody></table><h2 id="七、故障排除" tabindex="-1">七、故障排除 <a class="header-anchor" href="#七、故障排除" aria-label="Permalink to &quot;七、故障排除&quot;">​</a></h2><h3 id="_1-常见问题与解决方案" tabindex="-1">1. 常见问题与解决方案 <a class="header-anchor" href="#_1-常见问题与解决方案" aria-label="Permalink to &quot;1. 常见问题与解决方案&quot;">​</a></h3><p><strong>问题 1：变更集文件未被识别</strong></p><ul><li>原因：文件格式不正确或位置错误</li><li>解决：确保变更集文件在 <code>.changeset</code> 目录下，且格式正确</li></ul><p><strong>问题 2：版本更新失败</strong></p><ul><li>原因：包名配置错误或权限问题</li><li>解决：检查 <code>package.json</code> 中的包名和访问权限</li></ul><p><strong>问题 3：依赖关系未正确更新</strong></p><ul><li>原因：<code>updateInternalDependencies</code> 配置不当</li><li>解决：调整配置为 <code>patch</code> 或 <code>minor</code></li></ul><p><strong>问题 4：发布权限问题</strong></p><ul><li>原因：<code>@xxx/xx</code> 形式的包被当作私有包</li><li>解决：在 <code>package.json</code> 中配置 <code>publishConfig.access: &quot;public&quot;</code></li></ul><h3 id="_2-调试技巧" tabindex="-1">2. 调试技巧 <a class="header-anchor" href="#_2-调试技巧" aria-label="Permalink to &quot;2. 调试技巧&quot;">​</a></h3><p>（1）使用 <code>--verbose</code> 标志获取详细输出：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs:version</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --verbose</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>（2）检查变更集文件格式是否正确</p><p>（3）验证包名和版本号配置</p><p>（4）查看生成的 CHANGELOG.md 文件内容</p><p>（5）检查 Git 状态确认所有文件已正确提交</p><h3 id="_3-最佳实践" tabindex="-1">3. 最佳实践 <a class="header-anchor" href="#_3-最佳实践" aria-label="Permalink to &quot;3. 最佳实践&quot;">​</a></h3><p>（1）<strong>及时创建变更集</strong>：在完成功能开发后立即创建变更集</p><p>（2）<strong>详细描述变更</strong>：在变更集中提供足够详细的信息</p><p>（3）<strong>定期清理变更集</strong>：确保已处理的变更集文件被正确清理</p><p>（4）<strong>测试预发布版本</strong>：充分利用预发布功能进行测试</p><p>（5）<strong>团队协作规范</strong>：建立团队内的变更集创建和审核流程</p><p>（6）<strong>权限配置</strong>：对于需要特殊权限的包，在 <code>package.json</code> 中正确配置 <code>publishConfig</code></p><h2 id="八、高级配置" tabindex="-1">八、高级配置 <a class="header-anchor" href="#八、高级配置" aria-label="Permalink to &quot;八、高级配置&quot;">​</a></h2><h3 id="_1-自定义变更日志生成器" tabindex="-1">1. 自定义变更日志生成器 <a class="header-anchor" href="#_1-自定义变更日志生成器" aria-label="Permalink to &quot;1. 自定义变更日志生成器&quot;">​</a></h3><p>可以创建自定义的变更日志生成器：</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// .changeset/changelog-config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getReleaseLine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">changeset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 自定义变更日志行格式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  getDependencyReleaseLine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">changeset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dependencyChanges</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 自定义依赖变更行格式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_2-github-actions-集成" tabindex="-1">2. GitHub Actions 集成 <a class="header-anchor" href="#_2-github-actions-集成" aria-label="Permalink to &quot;2. GitHub Actions 集成&quot;">​</a></h3><p>可以配置 GitHub Actions 自动化发布流程：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Release</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  release</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm/action-setup@v2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/setup-node@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm install</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm cs:version</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm cs:release</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_3-版本策略配置" tabindex="-1">3. 版本策略配置 <a class="header-anchor" href="#_3-版本策略配置" aria-label="Permalink to &quot;3. 版本策略配置&quot;">​</a></h3><p>根据项目需求调整版本更新策略：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;updateInternalDependencies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;minor&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;___experimentalUnsafeOptions_WILL_CHANGE_IN_PATCH&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;onlyUpdatePeerDependentsWhenOutOfRange&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>通过合理的配置和使用，Changesets 可以成为 monorepo 项目版本管理的强大工具，提供精确的版本控制和灵活的发布流程。</p>`,274)])])}const C=a(k,[["render",c]]);export{y as __pageData,C as default};
